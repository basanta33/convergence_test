n_taxa
timeline <- v(20, 40, 60, 80, 105)
for(i in 1:(timeline.size() + 1))  {
    i
  # Define a exponential priors on the birth rate and turnover #
  speciation_rate[i] ~  dnExponential(10)
  turnover[i] ~ dnExponential(10)
  #extinction_rate ~  dnExponential(10)
  # Specify a scale move on the speciation_rate parameter #
  # This move will be applied with 3 different tuning values (lambda) to help improve mixing #
  moves[mvi++] = mvScale(speciation_rate[i], lambda=0.01, weight=1)
  moves[mvi++] = mvScale(speciation_rate[i], lambda=0.1,  weight=1)
  moves[mvi++] = mvScale(speciation_rate[i], lambda=1.0,  weight=1)
  # Specify a sliding-window move on the extinction_rate parameter #
  # This move will be applied with 3 different window widths (delta) to   help improve mixing #
  moves[mvi++] = mvScale(turnover[i], lambda=0.01, weight=1)
  moves[mvi++] = mvScale(turnover[i], lambda=0.1,  weight=1)
  moves[mvi++] = mvScale(turnover[i], lambda=1, weight=1)
  # Create deterministic nodes for extinction and diversification rates so that they can be monitored #
  extinction_rate[i] := turnover[i] * speciation_rate[i]
  diversification[i] := speciation_rate[i] - extinction_rate[i]
  #turnover := extinction_rate/speciation_rate
}
rho <- .1
for(i in 1:(timeline.size() + 1))
{
    i
    psi[i] ~ dnExponential(10)
    moves[mvi++] = mvScale(psi[i], lambda = 0.01, weight=1)
    moves[mvi++] = mvScale(psi[i], lambda = 0.1, weight=1)
    moves[mvi++] = mvScale(psi[i], lambda = 1, weight=1)
}
origin_time ~ dnUnif(110, 150)
origin_time
moves[mvi++] = mvSlide(origin_time, delta=0.01, weight=5.0)
moves[mvi++] = mvSlide(origin_time, delta=0.1,  weight=5.0)
moves[mvi++] = mvSlide(origin_time, delta=1, weight=5.0)
fbd_dist = dnFBDP(originAge=origin_time,lambda=speciation_rate, timeline=timeline, mu=extinction_rate, psi=psi, rho=rho, taxa=taxa)
agroecomyrmecinae = clade("Xymmer_muticus", "Tatuidris_tatusia")
amblyoponinae = clade("Prionopelta_MAD01", "Onychomyrmex_hedleyi", "Mystrium_mysticum", "Adetomyrma_MAD02", "Amblyopone_armigera", "Concoctio_concenta", "Myopopone_castanea", "Mystrium_voeltzkowi", "Onychomyrmex_doddi", "Prionopelta_aethiopica", "Myopopone_sinensis")
aneuretinae =  clade("Aenictus_eugenii", "Mianeuretus_mirabilis")
dolichoderinae = clade("Technomyrmex_voeltzkowi", "Dolichoderus_laminatus", "Tapinoma_opacum", "Ravavy_miafina", "Philidris_cordata", "Ochetellus_cf_glaber_clarithorax", "Nebothriomyrmex_majeri", "Liometopum_occidentale", "Leptomyrmex_AU01", "Leptomyrmex_erythrocephalus", "Linepithema_humile", "Iridomyrmex_pallidus", "Froggattella_latispina", "Dolichoderus_debilis", "Azteca_schimperi", "Anonychomyrma_itinerans", "Anonychomyrma_nitidiceps", "Tapinoma_erraticum", "Technomyrmex_albipes", "Iridomyrmex_purpureus",  "Leptomyrmex_erythrocephalus", "Liometopum_occidentale",  "Technomyrmex_voeltzkowi", "Protazteca_elongata")
dorylinae = clade("Vicinopone_conciliatrix", "Stenamma_snellingi", "Neivamyrmex_nigrescens", "Leptanilloides_gracilis", "Dorylus_laevigatus", "Dorymyrmex_elegans", "Cylindromyrmex_brevitarsus", "Cheliomyrmex_morosus", "Aptinoma_antongil", "Acanthostichus_punctiscapus", "Leptanilloides_femoralis", "Cerapachys_sexspinus", "Aenictus_turneri", "Leptanilliodes_biconstricta", "Simopone_schoutedeni", "Dorylus_helvolus", "Acanthostichus_serratulus", "Parasyscia_conservata")
ectatomminae = clade("Ectatomma_tuberculatum", "Gnamptogenys_annulata","Rhytidoponera_confusa", "Typhlomyrmex_pusillus", "Typhlomyrmex_rogenhoferi", "Acanthoponera_minor", "Heteroponera_brouni", "Heteroponera_relicta", "Ectatomma_tuberculatum", "Rhytidoponera_gibsoni")
formiciinae = clade("Titanomyrma_lubei")
formicinae = clade ("Zatania_gloriosa", "Wasmannia_auropunctata", "Pseudolasius_australis", "Polyrhachis_Hagio01", "Ochetomyrmex_neopolitus", "Nylanderia_parvula", "Notoncus_capitatus", "Camponotus_hyatti", "Brachymyrmex_depilis", "Acropyga_acutiventris", "Gesomyrmex_luzonensis", "Camponotus_conithorax", "Formica_wheeleri",  "Kyromyrma_sp", "Lasius_californicus", "Myrmecorhynchus_sp",  "Nylanderia_phantasma", "Oecophylla_smaragdina", "Plagiolepis_sp",  "Prenolepis_nitens",  "Pseudolasius_sp_PHL01", "Oecophylla_eckfeldiana")
heteroponerinae = clade("Heteroponera_brouni", "Heteroponera_relicta")
leptanillinae = clade("Protanilla_sp", "Anomalomyrma_sp", "Opamyrma_hungvuong", "Leptanilla_GRE01")
martialinae = clade("Martialis_heureka")
myrmeciinae =clade("Myrmeciites")
myrmicinae = clade("Tropidomyrmex_elianae", "Tranopelta_gilva", "Trachymyrmex_jamaicensis", "Tetramorium_spinosum", "Terataner_bottegoi", "Temnothorax_kutteri", "Talaridris_mandibularis", "Strumigenys_gundlachi", "Solenopsis_molesta", "Rhopalomastix_janeti", "Pristomyrmex_orbiceps", "Pogonomyrmex_imberbiculus", "Pheidole_antipodum", "Myrmica_kotokui", "Myrmecina_graminicola", "Monomorium_ergatogyna", "Malagidris_jugum", "Kalathomyrmex_emeryi", "Goniomma_blanci", "Formicoxenus_diversipilosus", "Dacatria_templaris","Crematogaster_acuta", "Cataulacus_hispidulus", "Cephalotes_texanus", "Cerapachys_splendens", "Carebara_affinis", "Cardiocondyla_mauritanica", "Apterostigma_auriculatum", "Aphaenogaster_albisetosa", "Anillomyrma_AFRC_TZ_01", "Acanthognathus_ocellatus", "Pogonomyrmex_californicus", "Myrmica_americana", "Myrmecorhynchus_sp", "Polyrhachis_Cyrto01", "Prenolepis_nitens", "Myrmecites_dubius")
paraponerinae = clade("Paraponera_clavata")
ponerinae = clade("Simopone_schoutedeni", "Plectroctena_minor", "Platythyrea_strenua","Pachycondyla_apicalis", "Pachycondyla_crassinoda", "Odontomachus_clarus", "Neoponera_commutata", "Myopias_tenuis", "Mesoponera_rubra", "Mayaponera_constricta", "Leptogenys_attenuata", "Hypoponera_opacior", "Euponera_sikorae", "Dinoponera_australis", "Diacamma_rugosum", "Brachyponera_chinensis", "Anochetus_madagascarensis", "Platythyrea_lamellosa", "Anochetus_emarginatus", "Odontomachus_bauri", "Asphinctopone_silvestrii", "Belonopelta_deletrix", "Austroponera_castanea", "Hypoponera_opacior", "Leptogenys_diminuta", "Odontomachus_bauri", "Pachycondyla_apicalis",  "Ponera_alpha", "Ponerites_crawleyi")
proceratiinae = clade("Proceratium_stictum", "Probolomyrmex_guineensis",  "Discothyrea_oculata", "Discothyrea_maya")
pseudomyrmecinae = clade("Tetraponera_rufonigra", "Pseudomyrmex_apache", "Tetraponera_rufonigra", "Pseudomyrmex_saxulum")
sphecomyrma = clade("Gerontoformica_gracilis", "Gerontoformica_magnus", "Gerontoformica_pilosus", "Gerontoformica_spiralis", "Cretomyrma_arnoldii")
haidomyrmicinae = clade("Haidomyrmex_scimitarus", "Haidomyrmodes_mammuthus", "Haidoterminus_cippus")
outgroup = clade("Metapolybia_cingulata", "Scolia_nobilitata", "Scolia_verticalis", "Apis_mellifera", "Aporus_niger", "Apterogyna_ZA01", "Chalybion_californicum", "Chyphotes_mellipes", "Chyphotes_sp", "Dasymutilla_aureola", "Sapyga_pumila", "Vespula_sp")
agroecomyrmecinae
amblyoponinae
aneuretinae
dolichoderinae
dorylinae
ectatomminae
ponerinae
constraints = v(agroecomyrmecinae, amblyoponinae, aneuretinae, dolichoderinae, dorylinae, ectatomminae, formiciinae, formicinae, heteroponerinae, leptanillinae, martialinae, myrmicinae, paraponerinae, ponerinae, proceratiinae, pseudomyrmecinae, sphecomyrma, haidomyrmicinae, outgroup)
fbd_tree ~ dnConstrainedTopology(fbd_dist, constraints)
fbd_tree.taxa()
agroecomyrmecinae = clade("Xymmer_muticus", "Tatuidris_tatusia")
amblyoponinae = clade("Prionopelta_MAD01", "Onychomyrmex_hedleyi", "Mystrium_mysticum", "Adetomyrma_MAD02", "Amblyopone_armigera", "Concoctio_concenta", "Myopopone_castanea", "Mystrium_voeltzkowi", "Onychomyrmex_doddi", "Prionopelta_aethiopica", "Myopopone_sinensis")
aneuretinae =  clade("Aenictus_eugenii", "Mianeuretus_mirabilis")
dolichoderinae = clade("Technomyrmex_voeltzkowi", "Dolichoderus_laminatus", "Tapinoma_opacum", "Ravavy_miafina", "Philidris_cordata", "Ochetellus_cf_glaber_clarithorax", "Nebothriomyrmex_majeri", "Liometopum_occidentale", "Leptomyrmex_AU01", "Leptomyrmex_erythrocephalus", "Linepithema_humile", "Iridomyrmex_pallidus", "Froggattella_latispina", "Dolichoderus_debilis", "Azteca_schimperi", "Anonychomyrma_itinerans", "Anonychomyrma_nitidiceps", "Tapinoma_erraticum", "Technomyrmex_albipes", "Iridomyrmex_purpureus" "Protazteca_elongata")
dorylinae = clade("Vicinopone_conciliatrix", "Stenamma_snellingi", "Neivamyrmex_nigrescens", "Leptanilloides_gracilis", "Dorylus_laevigatus", "Dorymyrmex_elegans", "Cylindromyrmex_brevitarsus", "Cheliomyrmex_morosus", "Aptinoma_antongil", "Acanthostichus_punctiscapus", "Leptanilloides_femoralis", "Cerapachys_sexspinus", "Aenictus_turneri", "Leptanilliodes_biconstricta", "Simopone_schoutedeni", "Dorylus_helvolus", "Acanthostichus_serratulus", "Parasyscia_conservata")
ectatomminae = clade("Ectatomma_tuberculatum", "Gnamptogenys_annulata","Rhytidoponera_confusa", "Typhlomyrmex_pusillus", "Typhlomyrmex_rogenhoferi", "Acanthoponera_minor", "Rhytidoponera_gibsoni")
formiciinae = clade("Titanomyrma_lubei")
formicinae = clade ("Zatania_gloriosa", "Wasmannia_auropunctata", "Pseudolasius_australis", "Polyrhachis_Hagio01", "Ochetomyrmex_neopolitus", "Nylanderia_parvula", "Notoncus_capitatus", "Camponotus_hyatti", "Brachymyrmex_depilis", "Acropyga_acutiventris", "Gesomyrmex_luzonensis", "Camponotus_conithorax", "Formica_wheeleri",  "Kyromyrma_sp", "Lasius_californicus", "Myrmecorhynchus_sp",  "Nylanderia_phantasma", "Oecophylla_smaragdina", "Plagiolepis_sp",  "Prenolepis_nitens",  "Pseudolasius_sp_PHL01", "Oecophylla_eckfeldiana")
heteroponerinae = clade("Heteroponera_brouni", "Heteroponera_relicta")
leptanillinae = clade("Protanilla_sp", "Anomalomyrma_sp", "Opamyrma_hungvuong", "Leptanilla_GRE01")
martialinae = clade("Martialis_heureka")
myrmeciinae =clade("Myrmeciites")
myrmicinae = clade("Tropidomyrmex_elianae", "Tranopelta_gilva", "Trachymyrmex_jamaicensis", "Tetramorium_spinosum", "Terataner_bottegoi", "Temnothorax_kutteri", "Talaridris_mandibularis", "Strumigenys_gundlachi", "Solenopsis_molesta", "Rhopalomastix_janeti", "Pristomyrmex_orbiceps", "Pogonomyrmex_imberbiculus", "Pheidole_antipodum", "Myrmica_kotokui", "Myrmecina_graminicola", "Monomorium_ergatogyna", "Malagidris_jugum", "Kalathomyrmex_emeryi", "Goniomma_blanci", "Formicoxenus_diversipilosus", "Dacatria_templaris","Crematogaster_acuta", "Cataulacus_hispidulus", "Cephalotes_texanus", "Cerapachys_splendens", "Carebara_affinis", "Cardiocondyla_mauritanica", "Apterostigma_auriculatum", "Aphaenogaster_albisetosa", "Anillomyrma_AFRC_TZ_01", "Acanthognathus_ocellatus", "Pogonomyrmex_californicus", "Myrmica_americana", "Polyrhachis_Cyrto01", "Myrmecites_dubius")
paraponerinae = clade("Paraponera_clavata")
ponerinae = clade("Plectroctena_minor", "Platythyrea_strenua","Pachycondyla_apicalis", "Pachycondyla_crassinoda", "Odontomachus_clarus", "Neoponera_commutata", "Myopias_tenuis", "Mesoponera_rubra", "Mayaponera_constricta", "Leptogenys_attenuata", "Hypoponera_opacior", "Euponera_sikorae", "Dinoponera_australis", "Diacamma_rugosum", "Brachyponera_chinensis", "Anochetus_madagascarensis", "Platythyrea_lamellosa", "Anochetus_emarginatus", "Asphinctopone_silvestrii", "Belonopelta_deletrix", "Austroponera_castanea", "Leptogenys_diminuta", "Odontomachus_bauri",  "Ponera_alpha", "Ponerites_crawleyi")
proceratiinae = clade("Proceratium_stictum", "Probolomyrmex_guineensis",  "Discothyrea_oculata", "Discothyrea_maya")
pseudomyrmecinae = clade("Tetraponera_rufonigra", "Pseudomyrmex_apache", "Pseudomyrmex_saxulum")
sphecomyrma = clade("Gerontoformica_gracilis", "Gerontoformica_magnus", "Gerontoformica_pilosus", "Gerontoformica_spiralis", "Cretomyrma_arnoldii")
haidomyrmicinae = clade("Haidomyrmex_scimitarus", "Haidomyrmodes_mammuthus", "Haidoterminus_cippus")
outgroup = clade("Metapolybia_cingulata", "Scolia_nobilitata", "Scolia_verticalis", "Apis_mellifera", "Aporus_niger", "Apterogyna_ZA01", "Chalybion_californicum", "Chyphotes_mellipes", "Chyphotes_sp", "Dasymutilla_aureola", "Sapyga_pumila", "Vespula_sp")
constraints = v(agroecomyrmecinae, amblyoponinae, aneuretinae, dolichoderinae, dorylinae, ectatomminae, formiciinae, formicinae, heteroponerinae, leptanillinae, martialinae, myrmicinae, paraponerinae, ponerinae, proceratiinae, pseudomyrmecinae, sphecomyrma, haidomyrmicinae, outgroup)
fbd_tree ~ dnConstrainedTopology(fbd_dist, constraints)
fbd_tree.ntaxa()
fbd.tree.taxa()
fbd_tree.taxa()
source("scripts/mcmc_TEFBD.Rev")
getwd()
setwd("C:\\\\Users\\\\basan\\\\Projects\\\\template_scripts\\\\random1_trial")
getwd()
source("scripts/mcmc_TEFBD.Rev")
setwd("C:\\\\Users\\\\basan\\\\Projects\\\\template_scripts\\\\random1_trial")
source("scripts/mcmc_TEFBD.Rev")
